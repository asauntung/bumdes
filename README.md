# Sistem Keuangan BUMDESa Margajaya

Platform manajemen keuangan desa yang transparan, akuntabel, dan aman. Dibangun dengan arsitektur modern menggunakan **React** (Frontend) dan **Supabase** (Backend/Database) untuk menjamin integritas data.

## ğŸ›¡ï¸ Arsitektur Keamanan & Fitur

Sistem ini tidak lagi menggunakan penyimpanan lokal (*localStorage*) yang rentan, melainkan database terpusat dengan proteksi berlapis:

### 1. Autentikasi Terenkripsi (Supabase Auth)

* Login menggunakan *Email/Password* yang dikelola oleh provider Supabase.
* **Zero Hardcoded Credentials**: Tidak ada password atau user yang ditulis dalam kode sumber.
* Manajemen sesi (JWT Token) otomatis dan aman.

### 2. Kontrol Akses (Row Level Security)

* **Direktur**: Memiliki otoritas penuh untuk validasi (*approve/reject*) transaksi.
* **Bendahara**: Terbatas pada input transaksi (status default: *pending*).
* Data dilindungi di level database: User tanpa hak akses valid tidak bisa memanipulasi data via API.

### 3. Transparansi & Validasi

* **Double-Entry Verification**: Setiap input dari Bendahara wajib melalui persetujuan Direktur sebelum masuk ke Buku Kas Umum (BKU).
* **Real-time Audit Trail**: Pencatatan waktu (*timestamp*) dan pelaku transaksi secara otomatis.

---

## âš ï¸ Protokol Keamanan (Wajib Dibaca)

Sebelum melakukan instalasi atau *deployment*, perhatikan hal berikut:

1. **Environment Variables**: Jangan pernah mem-push file `.env` ke repositori publik.
2. **Manajemen User**: Pembuatan akun Direktur/Bendahara dilakukan langsung melalui **Dashboard Supabase > Authentication**, bukan melalui kodingan.

---

## ğŸš€ Instalasi & Konfigurasi Lokal

### Langkah 1: Clone Repositori

```bash
git clone https://github.com/asauntung/bumdes.git
cd bumdes
npm install

```

### Langkah 2: Setup Environment Variables (KUNCI UTAMA)

Buat file bernama `.env` di folder root (sejajar dengan `package.json`). Salin kredensial dari Dashboard Supabase Anda:

```env
VITE_SUPABASE_URL=https://project-id-anda.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

```

> **PENTING**: Pastikan file `.env` sudah terdaftar di `.gitignore` agar tidak bocor ke GitHub.

### Langkah 3: Setup Database & RLS (Via Supabase SQL Editor)

Jalankan perintah SQL berikut di dashboard Supabase untuk membuat tabel yang aman:

```sql
-- 1. Buat Tabel Transaksi
create table public.transaksi (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  keterangan text not null,
  jumlah numeric not null,
  tipe text check (tipe in ('pemasukan', 'pengeluaran')),
  status text default 'pending' check (status in ('pending', 'approved', 'rejected')),
  user_id uuid references auth.users not null
);

-- 2. Aktifkan Keamanan Tingkat Baris (RLS)
alter table public.transaksi enable row level security;

-- 3. Policy: Izinkan user login melihat data
create policy "Enable read access for authenticated users"
on public.transaksi for select to authenticated using (true);

-- 4. Policy: Izinkan user login input data
create policy "Enable insert for authenticated users"
on public.transaksi for insert to authenticated with check (auth.uid() = user_id);

```

### Langkah 4: Jalankan Aplikasi

```bash
npm run dev

```

---

## â˜ï¸ Panduan Deployment (Vercel)

Untuk keamanan maksimal dan kemudahan manajemen *secret keys*, disarankan menggunakan **Vercel**:

1. Push kode Anda ke GitHub (Tanpa file `.env`).
2. Buka Vercel Dashboard, pilih **Add New Project** -> Import repositori ini.
3. Masuk ke bagian **Environment Variables** di setelan project Vercel.
4. Tambahkan variabel berikut:
* `VITE_SUPABASE_URL`
* `VITE_SUPABASE_ANON_KEY`


5. Klik **Deploy**.

---

## ğŸ“‚ Struktur Direktori

```
bumdes/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.jsx  # Middleware pengecekan login
â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx       # Interface utama
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â””â”€â”€ supabase.js         # Inisialisasi klien (Memanggil env vars)
â”‚   â”œâ”€â”€ App.jsx
â”‚   â””â”€â”€ main.jsx
â”œâ”€â”€ .env                        # FILE RAHASIA (Local only, ignored by git)
â”œâ”€â”€ .gitignore                  # Daftar pengecualian git
â””â”€â”€ package.json

```

---

## ğŸ¤ Kontribusi & Lisensi

Proyek ini bersifat *Open Source* untuk tujuan edukasi dan transparansi desa. Harap perhatikan aspek keamanan data warga saat melakukan *fork* atau pengembangan lebih lanjut.

**Dikembangkan untuk BUMDESa Margajaya**
